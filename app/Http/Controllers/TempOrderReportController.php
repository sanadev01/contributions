<?php

namespace App\Http\Controllers;

use App\Models\Order;
use App\Services\Excel\Export\TempOrderExport;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;

class TempOrderReportController extends Controller
{
    /**
     * Handle the incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function __invoke()
    { 
        $orders = Order::whereIn('corrios_tracking_code',[
            "NA466699629BR",
            "NA509276871BR",
            "NA509276899BR",
            "NA509285215BR",
            "NA550596346BR",
            "NA550596448BR",
            "NA550599183BR",
            "NA550599268BR",
            "NA550599271BR",
            "NA497687648BR",
            "NB188328706BR",
            "NA540088605BR",
            "NA540088619BR",
            "NA567889304BR",
            "NA557490234BR",
            "NA575300271BR",
            "NA591257360BR",
            "NA481262478BR",
            "NB041241638BR",
            "NA434932191BR",
            "NA550249457BR",
            "NA504383794BR",
            "NA455276828BR",
            "NA530463495BR",
            "NA530463527BR",
            "NA530465182BR",
            "NB053880023BR",
            "NB028304130BR",
            "NB028295225BR",
            "NA545487140BR",
            "NA354099995BR",
            "NA481367133BR",
            "NA594038213BR",
            "NA434504839BR",
            "NA460071552BR",
            "NA460071610BR",
            "NA550683615BR",
            "NA610046048BR",
            "NA443054744BR",
            "NA609891102BR",
            "NA455227257BR",
            "NA455227265BR",
            "NA455234995BR",
            "NA361335139BR",
            "NA550738645BR",
            "NA590822010BR",
            "NA466713232BR",
            "NA466700083BR",
            "NB203398542BR",
            "NB207213938BR",
            "NB211861196BR",
            "NA356968080BR",
            "NA360563951BR",
            "NA521655740BR",
            "NA558126989BR",
            "NB179296850BR",
            "NB189326794BR",
            "NB202920109BR",
            "NB203644708BR",
            "NB207077203BR",
            "NB207088435BR",
            "NB207100176BR",
            "NA303280121BR",
            "NA567705155BR",
            "NA434209880BR",
            "NA459268376BR",
            "NA516327110BR",
            "NA599933993BR",
            "NA902569531BR",
            "NA371973042BR",
            "NA371979558BR",
            "NA463925428BR",
            "NA463925431BR",
            "NA463925445BR",
            "NA545664162BR",
            "NA463547540BR",
            "NB182479331BR",
            "NB182640005BR",
            "NB185332794BR",
            "NB185487986BR",
            "NB185512898BR",
            "NB191460191BR",
            "NB191633997BR",
            "NB191809455BR",
            "NB191843205BR",
            "NB192081575BR",
            "NB192242581BR",
            "NB192301333BR",
            "NB194427521BR",
            "NA895748711BR",
            "NA895748708BR",
            "NA847527383BR",
            "NA851386850BR",
            "NA851593450BR",
            "NA856039698BR",
            "NA856050804BR",
            "NA856050985BR",
            "NA856180870BR",
            "NA856216591BR",
            "NA856902878BR",
            "NA914907599BR",
            "NB002997062BR",
            "NB182138156BR",
            "NB191708908BR",
            "NB199584475BR",
            "NB199610277BR",
            "NB199635818BR",
            "NB199636036BR",
            "NB199631691BR",
            "NB199698716BR",
            "NB199798705BR",
            "NB199831154BR",
            "NB199831888BR",
            "NB199841885BR",
            "NB203041092BR",
            "NB203074759BR",
            "NB203075547BR",
            "NB203391685BR",
            "NB203408749BR",
            "NB203495195BR",
            "NB203509084BR",
            "NB206318870BR",
            "NB206323804BR",
            "NB206440893BR",
            "NB206463832BR",
            "NB206507184BR",
            "NB206513975BR",
            "NB206515565BR",
            "NB206860595BR",
            "NB206870782BR",
            "NB206926124BR",
            "NB206942759BR",
            "NB210106973BR",
            "NB210105195BR",
            "NB210109232BR",
            "NB210131200BR",
            "NB210186058BR",
            "NB210250207BR",
            "NB210483847BR",
            "NB210515108BR",
            "NB210511287BR",
            "NB210516681BR",
            "NB210517086BR",
            "NB210520244BR",
            "NB210525652BR",
            "NB210526318BR",
            "NB210567405BR",
            "NB210570435BR",
            "NB214184211BR",
            "NB214185733BR",
            "NB214201348BR",
            "NB214203281BR",
            "NB214207306BR",
            "NB214246066BR",
            "NB276721618BR",
            "NB276870784BR",
        ])->get();
        $export =  new TempOrderExport($orders,Auth::id());
            $export->handle();
        return $export->download();
    }
}
